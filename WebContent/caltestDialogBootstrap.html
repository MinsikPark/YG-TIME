<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>YG-TIME Calendar</title>
	<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
	<link rel="stylesheet" href="fullcalendar/fullcalendar.css" />
	<link rel='stylesheet' href="fullcalendar/fullcalendar.print.min.css" media="print" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.42/css/bootstrap-datetimepicker.min.css" />
	
	<script src="fullcalendar/lib/jquery.min.js"></script>
	<script src="fullcalendar/lib/moment.min.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.42/js/bootstrap-datetimepicker.min.js"></script>
	<!-- (주의)fullcalendar.js import가 가장 마지막 라인에 작성되어야 함 -->
	<script src="fullcalendar/fullcalendar.js"></script>
	<script src="fullcalendar/locale-all.js"></script>
	<!-- script -->
	<script type="text/javascript">
	/*TODO
		1)
		날짜 클릭
		보드명
		기간 설정
		세부내용 (설명)
		보드바 색
	*/
	
		$(function() { // $(document).ready.
			$('#delete').click(function() {
				$('#calendar').fullCalendar('removeEvents', 'jino');
			});
		
			$('#deleteAll').click(function() {
				$('#calendar').fullCalendar('removeEvents');
			});
			
			//fullCalendar
			$('#calendar').fullCalendar({
				header: {
			  		left: 'prev, next today',
			  		center: 'title',
			  		right: 'listYear, listMonth'
				},
				views: {
		  			listMonth: {
		    			buttonText: 'list month'
			  		},
			  		listYear: {
		    			buttonText: 'list year'
			  		}
				},
				defaultDate: moment().format('YYYY-MM-DD'),
				locale: 'ko',
				selectable: true, //일자를 클릭, 드래그 가능
				selectHelper: true, //일자 드래그하면 보드바를 표시
				select: function(start, end) { //이벤트객체에 입력될 시작일, 종료일 파라미터
					//$('#eventStart').val(start.format()); // start.format() : 시작일 값
					//$('#eventStart').datepicker({dateFormat: 'yy-mm-dd'}); //시작일 Datepicker
		            //$('#eventEnd').datepicker({dateFormat: 'yy-mm-dd'}); //종료일 Datepicker
					//$('#calEventDialog').dialog('open');
					$('.modal').modal('show');
				},
				editable: true, // 달력에 종료일 수정 여부 (드래그, 크기 조정)
				eventLimit: true, // 하루에 표시되는 이벤트의 수를 제한. 나머지는 팝 오버에 나타남.
				displayEventTime: false,
				events: [
					{
						id: 'jino',
						title: '지너니',
						start: '2018-04-07',
						end: '2018-04-10',
						color: '#000000'
					},
					{
						title: '재우기',
						url: 'http://www.daum.net/',
						start: '2018-04-15',
						end: '2018-04-17',
						color: '#336699'
					},
					{
						title: '윤그니',
						url: 'http://www.naver.com/',
						start: '2018-04-20',
						end: '2018-04-22',
						color: 'red'
					}
				],
			}); // end - fullCalendar
			
			$('#eventStart, #eventEnd').datetimepicker();
			
			$('#calEventDialog').dialog({ //dialog 설정
				resizable: false,
				autoOpen: false,
				title: 'Add Board',
				width: 500,
				buttons: {
					Add: function() {
						var title = $('#eventTitle'); //제목 
						var start = $('#eventStart'); //시작일
						var end = $('#eventEnd'); //종료일
						var color = $('#eventColor');
						var eventData; //이벤트 객체 변수 선언
						
						if(title.val() !== '') {
							eventData = {
								id: 'test',
								title: title.val(),
								start: start.val(),
								//end: end.val() + " 23:59:59",  //end.val()로 정확한 일자값을 넣어주면 종료일 전날로 표시 되므로, 종료일의 23시 59분 59초로 설정
								end: end.val(),
								color: color.val(),
							};
							console.log(end);
							$('#calendar').fullCalendar('renderEvent', eventData, true);
						}
						$('#calendar').fullCalendar('unselect');
						$(this).dialog('close');
					},
					Cancel: function() {
						$(this).dialog('close');
					}
				},
			}); // end - dialog
			
			// Bind the dates to datetimepicker.
	        // You should pass the options you need
	        $("#starts-at, #ends-at").datetimepicker();

	        // Whenever the user clicks on the "save" button om the dialog
	        $('#save-event').on('click', function() {
	            var title = $('#title').val();
	            if (title) {
	                var eventData = {
	                    title: title,
	                    start: $('#starts-at').val(),
	                    end: $('#ends-at').val()
	                };
	                $('#calendar').fullCalendar('renderEvent', eventData, true); // stick? = true
	            }
	            $('#calendar').fullCalendar('unselect');

	            // Clear modal inputs
	            $('.modal').find('input').val('');

	            // hide modal
	            $('.modal').modal('hide');
	        });
			
		}); // end - jquery
	</script>
	<!-- style -->
	<style type="text/css">
		#calendar {
		    max-width: 900px;
		    margin: 0 auto;
		}
	</style>
</head>
<body>
	<!-- 달력 표시되는 영역 -->
	<button id="delete">지너니삭제</button><button id="deleteAll">전체삭제</button><br>
	<button id="eventDate">이벤트 시작/종료 일자</button>
	<div id="calendar"></div>
	<div id="datepicker"></div>
	<div id="testpage"></div>
	
	<!-- Dialog 영역 -->
	<!-- 초기에 깜빡이는 것을 없애기 위해 <div hidden ...> 사용 -->
	<div hidden id="calEventDialog">
	    <form>
	        <fieldset>
		        <label for="eventTitle">Title</label>
		        <input type="text" name="eventTitle" id="eventTitle" /><br>
		        <label for="eventStart">Start Date</label>
		        <input type="text" name="eventStart" id="eventStart" /><br>
		        <label for="eventEnd">End Date</label>
		        <input type="text" name="eventEnd" id="eventEnd" /><br>
		        <label for="eventColor">BoardBar Color</label>
		        <input type="color" name="eventColor" id="eventColor" /><br>
	        </fieldset>
	    </form>
	</div>
	
	
	<!-- Modal 영역 -->
	<div class="modal fade" tabindex="-1" role="dialog">
	    <div class="modal-dialog" role="document">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	                <h4 class="modal-title">Create new event</h4>
	            </div>
	            <div class="modal-body">
	                <div class="row">
	                    <div class="col-xs-12">
	                        <label class="col-xs-4" for="title">Event title</label>
	                        <input type="text" name="title" id="title" />
	                    </div>
	                </div>
	                <div class="row">
	                    <div class="col-xs-12">
	                        <label class="col-xs-4" for="starts-at">Starts at</label>
	                        <input type="text" name="starts_at" id="starts-at" />
	                    </div>
	                </div>
	                <div class="row">
	                    <div class="col-xs-12">
	                        <label class="col-xs-4" for="ends-at">Ends at</label>
	                        <input type="text" name="ends_at" id="ends-at" />
	                    </div>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	                <button type="button" class="btn btn-primary" id="save-event">Save changes</button>
	            </div>
	        </div><!-- /.modal-content -->
	    </div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
	
</body>
</html>